datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model Player {
  id               String             @id @default(cuid())
  name             String
  email            String             @unique
  telegram         String?
  joinedAt         DateTime           @default(now())
  tournaments      Tournament[]
  statistics       PlayerStatistics?
  TournamentResult TournamentResult[]
}

model Tournament {
  id       String             @id @default(cuid())
  date     DateTime
  location String
  players  Player[]
  results  TournamentResult[]
}

model TournamentResult {
  id           String     @id @default(cuid())
  player       Player     @relation(fields: [playerId], references: [id])
  playerId     String
  tournament   Tournament @relation(fields: [tournamentId], references: [id])
  tournamentId String
  points       Int
  rank         Int
}

model PlayerStatistics {
  id               String @id @default(cuid())
  player           Player @relation(fields: [playerId], references: [id])
  playerId         String @unique
  totalPoints      Int    @default(0)
  totalTournaments Int    @default(0)
  averageRank      Float  @default(0)
}
